(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;Math.randomInt=function(a,b){return Math.floor(Math.random()*(b-a+1)+a)},c=illuminated.Lamp,f=illuminated.RectangleObject,b=illuminated.DiscObject,e=illuminated.PolygonObject,h=illuminated.Vec2,d=illuminated.Lighting,a=illuminated.DarkMask,i=document.getElementsByTagName("canvas")[0],l=i.getContext("2d"),i.width=window.innerWidth,i.height=window.innerHeight,t={assets:"../assets/"},s=new Image,s.onload=function(){var a;return a=!0},s.src="../assets/galvanized-plate.jpg",o=function(a){return null==a&&(a=0),q.load(a),requestAnimFrame(function b(){requestAnimFrame(b,i);var a=+new Date;a>=p+g&&(p=a,x()),u()},i)},m=null,r=[],q={add:function(a){return a.lightings=[],r.push(a)},get:function(a){return m=r[a]},load:function(a){var b;return b=null,m=null,q.get(a),k(),w()}},n=null,k=function(){var b,c,e,f,g;for(n=new a({lights:m.lights,color:"rgba(0,0,0,0.8)"}),f=m.lights,g=[],c=0,e=f.length;e>c;c++)b=f[c],g.push(m.lightings.push(new d({light:b,objects:m.objects})));return g},j=function(){var a,b,c,d,e;for(d=m.lightings,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.compute(i.width,i.height));return e},v=function(){var a,b,c,d,e;for(d=m.lightings,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.render(l));return e},p=0,g=25,x=function(){return j(),n.compute(i.width,i.height)},w=function(){return x()},u=function(){var a,b;return b=i.width,a=i.height,l.fillStyle="#000",l.fillRect(0,0,b,a),l.save(),l.fillStyle="white",m.objects.forEach(function(a){var b,c,d;return l.save(),l.beginPath(),a.path(l),l.clip(),c=a.bounds(),d=c.topleft,b=c.bottomright,l.drawImage(resources.get(a.texture),d.x,d.y,b.x-d.x,b.y-d.y),l.restore(),l.save(),l.lineWidth=1,l.strokeStyle="#778",l.beginPath(),a.path(l),l.stroke(),l.restore()}),l.globalCompositeOperation="lighter",v(),l.restore(),l.globalCompositeOperation="source-over",n.render(l)},q.add({objects:[new f({topleft:new h(0,150),bottomright:new h(i.width,175),texture:t.assets+"level-0/background.png"}),new f({topleft:new h(0,i.height-175),bottomright:new h(i.width,i.height-150),texture:t.assets+"level-0/background.png"}),new f({topleft:new h(100,i.height-500),bottomright:new h(250,i.height-175),texture:t.assets+"player.png"})],lights:[new c({color:"rgba(255, 220, 150, 0.6)",distance:300}),new c({color:"rgba(255, 220, 150, 0.6)",distance:300,position:new h(500,500)})]}),q.add({objects:[new f({topleft:new h(0,600),bottomright:new h(i.width,100)})],lights:[new c({color:"rgba(255, 0, 0, 1)",distance:30}),new c({color:"rgba(255, 255, 255, 0.2)",distance:100,position:new h(600,700)})]}),q.add({objects:[new f({topleft:new h(0,600),bottomright:new h(i.width/2,50)})],lights:[new c({color:"rgba(0, 255, 0, 1)",distance:30})]}),resources.load([t.assets+"player.png",t.assets+"level-0/background.png"]),resources.onReady(o)}).call(this);