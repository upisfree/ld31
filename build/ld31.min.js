(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;Math.randomInt=function(a,b){return Math.floor(Math.random()*(b-a+1)+a)},c=illuminated.Lamp,f=illuminated.RectangleObject,b=illuminated.DiscObject,e=illuminated.PolygonObject,h=illuminated.Vec2,d=illuminated.Lighting,a=illuminated.DarkMask,i=document.getElementsByTagName("canvas")[0],l=i.getContext("2d"),i.width=window.innerWidth,i.height=window.innerHeight,s={assets:"../assets/"},o=function(a){return null==a&&(a=0),q.load(a),requestAnimFrame(function b(){requestAnimFrame(b,i);var a=+new Date;a>=p+g&&(p=a,w()),t()},i)},m=null,r=[],q={add:function(a){return a.lightings=[],r.push(a)},get:function(a){return m=r[a]},load:function(a){var b;return b=null,m=null,q.get(a),k(),v(),m.action()}},n=null,k=function(){var b,c,e,f,g;for(n=new a({lights:m.lights,color:"rgba(0, 0, 0, 1)"}),f=m.lights,g=[],c=0,e=f.length;e>c;c++)b=f[c],g.push(m.lightings.push(new d({light:b,objects:m.objects})));return g},j=function(){var a,b,c,d,e;for(d=m.lightings,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.compute(i.width,i.height));return e},u=function(){var a,b,c,d,e;for(d=m.lightings,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.render(l));return e},p=0,g=25,w=function(){return j(),n.compute(i.width,i.height)},v=function(){return w()},t=function(){var a,b;return b=i.width,a=i.height,l.fillRect(0,0,b,a),l.save(),l.fillStyle="white",m.objects.forEach(function(a){var b,c,d;return l.save(),l.beginPath(),a.path(l),l.clip(),c=a.bounds(),d=c.topleft,b=c.bottomright,l.drawImage(resources.get(a.texture),d.x,d.y,b.x-d.x,b.y-d.y),l.restore(),l.save(),l.beginPath(),a.path(l),l.restore()}),l.globalCompositeOperation="lighter",u(),l.restore(),l.globalCompositeOperation="source-over",n.render(l)},q.add({objects:[new f({topleft:new h(i.width/1.5-162.5,i.height-275),bottomright:new h(i.width/1.5+162.5,i.height-175),texture:s.assets+"player-lying.png"})],lights:[new c({color:"rgba(189, 0, 0, 0.9)",position:new h(i.width/1.5,176),distance:300,diffuse:.8,radius:0,samples:1,roughness:1,angle:-26.75}),new c({color:"rgba(250, 220, 150, 0.8)",position:new h(i.width/5,176),distance:1,diffuse:.8,radius:0,samples:1,roughness:1,angle:-26.75}),new c({color:"rgba(250, 220, 150, 0.8)",position:new h(i.width/2,176),distance:1,diffuse:.8,radius:0,samples:1,roughness:1,angle:-26.75}),new c({color:"rgba(250, 220, 150, 0.8)",position:new h(i.width/1.25,176),distance:1,diffuse:.8,radius:0,samples:1,roughness:1,angle:-26.75}),new c({color:"rgba(255, 255, 255, 1)",position:new h(i.width/2,i.height/2),distance:1,radius:10})],action:function(){var a,b;return a=setInterval(function(){return m.lights[0].distance=Math.random()>.5?1:300},2e3),b=resources.get(s.assets+"level-0/siren.mp3"),b.play(),setTimeout(function(){var b;return clearInterval(a),m.lights[0].distance=1,b=resources.get(s.assets+"level-0/dimple-pinch-neat.mp3"),b.volume(.5),b.loop=!0,b.play(),setTimeout(function(){return m.lights[1].distance=300,m.lights[2].distance=300,m.lights[3].distance=300,m.lights[4].distance=50,m.objects[0].texture=s.assets+"null.png",m.objects.push(new f({topleft:new h(i.width/1.5-75,i.height-500),bottomright:new h(i.width/1.5+75,i.height-175),texture:s.assets+"player.png"})),window.onkeydown=function(a){switch(a.keyCode){case 38:m.lights[4].position.y-=10;break;case 37:m.lights[4].position.x-=10;break;case 40:m.lights[4].position.y+=10;break;case 39:m.lights[4].position.x+=10}return m.lights[4].position.x+10>=m.objects[1].topleft.x&&m.lights[4].position.x<=m.objects[1].bottomright.x&&m.lights[4].position.y+10>=m.objects[1].topleft.y&&m.lights[4].position.y<=m.objects[1].bottomright.y?($("#level-0-message").fadeIn("fast"),setTimeout(function(){return $("#level-0-message").fadeOut("fast")},5e3)):void 0}},2e3)},8e3)}}),q.add({objects:[new f({topleft:new h(0,600),bottomright:new h(i.width,100)}),new f({topleft:new h(100,i.height-500),bottomright:new h(250,i.height-175),texture:s.assets+"player.png"})],lights:[new c({color:"rgba(255, 0, 0, 1)",distance:30}),new c({color:"rgba(255, 255, 255, 0.2)",distance:100,position:new h(600,700)})]}),q.add({objects:[new f({topleft:new h(0,600),bottomright:new h(i.width/2,50)})],lights:[new c({color:"rgba(0, 255, 0, 1)",distance:30})]}),resources.load([s.assets+"player.png",s.assets+"player-lying.png",s.assets+"null.png",s.assets+"level-0/background.png",s.assets+"level-0/siren.mp3",s.assets+"level-0/dimple-pinch-neat.mp3"]),resources.onReady(o)}).call(this);